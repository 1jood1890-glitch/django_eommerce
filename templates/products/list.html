{% extends "base.html" %}

{% block title %}قائمة المنتجات{% endblock %}

{% block content %}
<style>
    /* هيدر الصفحة بتدرج لوني احترافي */
    .product-header {
        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        color: white;
        padding: 60px 0;
        border-radius: 0 0 50px 50px;
        margin-bottom: 40px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .product-card {
        border: none;
        border-radius: 20px;
        transition: all 0.4s ease;
        background: #ffffff;
        border: 1px solid #f0f0f0;
    }

    .product-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 15px 30px rgba(0,0,0,0.1) !important;
    }

    .price-tag {
        color: #11998e;
        font-weight: 800;
        font-size: 1.25rem;
    }

    .img-container {
        height: 220px;
        overflow: hidden;
        background: #f8f9fa;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 10px;
    }

    .btn-action {
        border-radius: 12px;
        font-weight: 600;
        transition: 0.3s;
    }
</style>

<div class="product-header text-center">
    <h1 class="display-5 fw-bold">{{ title }}</h1>
    <p class="lead opacity-75">تم العثور على {{ prod|length }} منتج متاح</p>
</div>
  
<div class="container mb-5">
    <div class="row justify-content-center mb-5">
        <div class="col-md-7">
            <form method="GET" action="{% url 'list' %}">
                <div class="input-group shadow-sm rounded-pill overflow-hidden">
                    <input type="text" name="search" class="form-control border-0 px-4 py-3" placeholder="ابحث عن منتج بالاسم..." value="{{ request.GET.search|default:'' }}">
                    <button class="btn btn-primary px-4" type="submit">بحث</button>
                </div>
            </form>
        </div>
    </div>

    <div class="row g-4">
        {% for product in prod %}
        <div class="col-md-4 col-lg-3">
            <div class="card product-card shadow-sm h-100 overflow-hidden">
                <div class="img-container">
                    {% if product.image_url %}
                        <img src="{{ product.image_url }}" class="img-fluid" style="max-height: 100%; object-fit: contain;" alt="{{ product.name }}">
                    {% else %}
                        <i class="fas fa-image fa-4x text-light"></i>
                    {% endif %}
                </div>

                <div class="card-body text-center d-flex flex-column">
                    <h5 class="card-title fw-bold text-dark mb-2">{{ product.name }}</h5>
                    <p class="text-muted small mb-3">{{ product.details|truncatechars:40 }}</p>
                    
                    <div class="mt-auto mb-3">
                        <span class="price-tag">{{ product.price|floatformat:2 }} ر.س</span>
                    </div>
                    
                    <div class="d-flex gap-2">
                        <a class="btn btn-outline-success btn-action w-100 py-2" href="{% url 'details' product.id %}">
                            تفاصيل
                        </a>
                        <a class="btn btn-primary btn-action w-100 py-2 shadow-sm" href="{% url 'add_to_cart' %}">
                            السلة
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12 text-center py-5">
            <div class="mb-3">
                <i class="fas fa-search fa-4x text-muted opacity-25"></i>
            </div>
            <h3 class="text-muted">نأسف، لا توجد نتائج مطابقة لبحثك.</h3>
            <a href="{% url 'list' %}" class="btn btn-outline-primary mt-3 rounded-pill">عرض كل المنتجات</a>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}